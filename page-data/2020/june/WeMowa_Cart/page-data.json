{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/june/WeMowa_Cart/","result":{"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"0c97f28b-a1d6-5732-a088-12c58e0f9f65","excerpt":"Cart 카트 Structure 카트가 비어있을 경우 total $0? total item === 0? Show “You haven’t added anything yet” message component…","html":"<h1>Cart</h1>\n<h3>카트 Structure</h3>\n<ol>\n<li>카트가 비어있을 경우</li>\n<li>total $0?</li>\n<li>total item === 0?</li>\n<li>Show “You haven’t added anything yet” message component</li>\n<li>카트에 아이템이 담겨있을 경우</li>\n<li>담겨있는 아이템 리스트</li>\n<li>아이템 총 금액, 배송비, 총 결제비용</li>\n<li>담겨있는 아이템 갯수</li>\n</ol>\n<h3>ShoppingBag.js</h3>\n<ol>\n<li>유저가 쇼핑백에 넣은 제품의 데이터는 Parent 인 Shopping Bag의 State 에 있다. 우선은 State 에 직접 mock data 를 넣어주었다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  testProducts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      pn<span class=\"token operator\">:</span> <span class=\"token number\">92585004</span><span class=\"token punctuation\">,</span>\n      collection<span class=\"token operator\">:</span> <span class=\"token string\">\"original\"</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">\"Truck XL\"</span><span class=\"token punctuation\">,</span>\n      size<span class=\"token operator\">:</span> <span class=\"token string\">\"80 x 44 x 46\"</span><span class=\"token punctuation\">,</span>\n      price<span class=\"token operator\">:</span> <span class=\"token number\">1530</span><span class=\"token punctuation\">,</span>\n      qty<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      pn<span class=\"token operator\">:</span> <span class=\"token number\">92590041</span><span class=\"token punctuation\">,</span>\n      collection<span class=\"token operator\">:</span> <span class=\"token string\">\"classic\"</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">,</span>\n      size<span class=\"token operator\">:</span> <span class=\"token string\">\"55 x 40 x 23\"</span><span class=\"token punctuation\">,</span>\n      price<span class=\"token operator\">:</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span>\n      qty<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      pn<span class=\"token operator\">:</span> <span class=\"token number\">92552014</span><span class=\"token punctuation\">,</span>\n      collection<span class=\"token operator\">:</span> <span class=\"token string\">\"original\"</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">\"Cabin S\"</span><span class=\"token punctuation\">,</span>\n      size<span class=\"token operator\">:</span> <span class=\"token string\">\"55 x 40 x 20\"</span><span class=\"token punctuation\">,</span>\n      price<span class=\"token operator\">:</span> <span class=\"token number\">1230</span><span class=\"token punctuation\">,</span>\n      qty<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"2\">\n<li>render 에 세가지 섹션을 만들어 주었다.</li>\n<li>\n<p>cartHeader</p>\n<ul>\n<li>쇼핑백에 담긴 물건의 갯수</li>\n<li>아무 물건이 담겨있지 않았을 때 메시지와 Start Shopping 버튼</li>\n</ul>\n</li>\n<li>\n<p>cartItems</p>\n<ul>\n<li><CartItem> 컴포넌트가 state 의 담긴 products 갯수만큼 map이 된다</li>\n</ul>\n</li>\n<li>\n<p>cartTotal</p>\n<ul>\n<li><cartTotal> 컴포넌트. 총 금액과 배송비, 세금 등을 보여준다.</li>\n</ul>\n</li>\n<li>우선 cartItems 섹션. Map 을 돌리고 각 제품마다 State 에서 데이터를 받아 CartItem컴포넌트에 넘겨줄 정보를 지정해준다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>products<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CartItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>p<span class=\"token punctuation\">.</span>pn<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">product</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>p<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>CartItem.js</h3>\n<ol>\n<li>CartItem 섹션</li>\n<li>이미지</li>\n<li>제품 정보 (collection, name, price, color)</li>\n<li>유저가 담은 갯수, Delete 버튼, 갯수에 다른 Subtotal</li>\n<li>필요한 곳에 props 로부터 받은 데이터를 넣어준다</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span>qty<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ol start=\"3\">\n<li>Qty는 더해주거나 빼줄 수 있다.</li>\n<li>Max Qty 가 있는지?</li>\n<li>1 미만은 선택할 수 없다.</li>\n</ol>\n<p>더하기 빼기는 parent state 의 qty 를 업데이트 해주어야 하므로 parent 에서 handle 되어야한다. 버튼을 눌렀을 때 parent 에 method 를 불러오게 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handlePlus</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Plus</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>지금 누른 버튼에 해당되는 제품을 업데이트 해주어야하므로 this.props.proudct 를 reference 해준다.</li>\n</ul>\n<h3>Back to ShoppingBag.js</h3>\n<ol>\n<li>CartItem 컴포넌트에 handlePlus 를 넘겨준다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CartItem</span></span> <span class=\"token attr-name\">handlePlus</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlePlus<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<ol start=\"2\">\n<li>handlePlus 메소드를 만들어주고 잘 적용이 되었는지 console.log 로 확인해 준다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function-variable function\">handlePlus</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">product</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>product<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"3\">\n<li>이제 이 메소드를 통해 state 의 testProducts 의 qty 를 업데이트 해주어야한다.\n여기서 중요한 것은 바로 state 의 값을 업데이트 해주지 말아야 한다는 것이다. In the React <a href=\"https://reactjs.org/docs/react-component.html\">official doc</a>, it says to treat this.state as if it were immutable.</li>\n</ol>\n<p>대신, 제품 array 를 메소드 안에서 clone 해주고 (여기서 clone 은 reference해준다는 말)</p>\n<p>메소드 안에서 products 라는 새로운 const 를 만들어주고 this.state.product 를 클론해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> products <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>products<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>지금 이 array 는 this.state.product 와 같다. reference 이다.</li>\n<li>products[0].qty++ 같이 directly modify 해주면 안된다. because it’s going to directly modify the state.products.</li>\n</ul>\n<blockquote>\n<p>to solve this problem, we need to clone the product at the given location so we’ll have a different object than the one in the state. we don’t have to clone the other product objects here because we’re not going to modify them.</p>\n</blockquote>\n<p>각 제품object 도 클론 해와야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> products<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>product<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 각 제품의 index 를 받아온다음</span>\nproducts<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>product <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//products의 각각 오브젝트를 클론해온다</span></code></pre></div>\n<p>그리고 클론해온 그 오브젝트를 업데이트 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">products<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>qty<span class=\"token operator\">++</span></code></pre></div>","frontmatter":{"title":"WeMowa Cart","date":"June 05, 2020","description":"Creating Cart"}}},"pageContext":{"slug":"/2020/june/WeMowa_Cart/","previous":{"fields":{"slug":"/2020/may/RegEx/"},"frontmatter":{"title":"RegEx"}},"next":{"fields":{"slug":"/2020/june/WeMowa/"},"frontmatter":{"title":"WeMowa"}}}}}